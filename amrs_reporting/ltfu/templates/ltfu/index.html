{% extends "ltfu/base.html" %}

{% block content %}

<script type="text/javascript">
  $(document).ready(function() {

  var oTable = $('#ltfu_stats').dataTable( {
  "sScrollY": "150px",
  "aaSorting" : [[5,"asc"]],
  "aaColumns" : [null,null,null,null,null,null],
  "bJQueryUI": true,
  "bPaginate": false,
  "bLengthChange": false,
  "bFilter": true,
  "bSort": true,
  "bInfo": false,
  "bAutoWidth": false } );

  $("#ltfu_date").datepicker({dateFormat: 'yy-mm-dd', changeMonth:true,changeYear:true} );

  });


</script>
<h4>Lost to Follow-up (LTFU)</h4>
<table id='ltfu_stats'>
  <thead>
    <tr>
      <td>Clinic</td>
      <td>LTFU at 2014/01/01</td>
      <td>Current LTFU: </td>
      <td>% change</td>
      <td>Absolute change</td>
      <td>Rank</td>
    </tr>
  </thead>
  <tbody>
    {% for row in ltfu_stats %}
    <tr>
      <td>{{row.name}}</td>
      <td>{{row.ltfu_at_start_date}}</td>
      <td>{{row.ltfu}}</td>
      <td>{{row.percent_change}}</td>
      <td>{{row.abs_change}}</td>
      <td>{{row.rank}}</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
<ul>
  <li><a href='/ltfu/ltfu_ampath'>AMPATH-wide LTFU statistics by year</a><br/><br/></li>
  <li><a href='/ltfu/ltfu_clinics'>LTFU statistics across all clinics</a><br/><br/></li>
  <li> <b>List all LTFU patients at a specific clinic:</b>
    <form action='/ltfu/ltfu_clinic' method='post'> {% csrf_token %}
    <table>
      <tr>
	<td>Clinic: 
	  <select name='location_id'>
	    {% for location in locations %}
	    <option value='{{location.location_id}}'>{{location.name}}</option>
	    {% endfor %}
	  </select>
	</td>
	<td>LTFU Date : <input id='ltfu_date' type='text' name='ltfu_date' value='2014-01-01'/></td>
	<td><input type='submit'/></td>
      </tr>	  
    </table>
    </form>
  </li>
  <li> <b>Identify patients about to be designated LTFU</b>
    <form action='/ltfu/ltfu_by_range' method='post'> {% csrf_token %}
      <table>
      <tr>
	<td>Clinic: 
	  <select name='location_id'>
	    {% for location in locations %}
	    <option value='{{location.location_id}}'>{{location.name}}</option>
	    {% endfor %}
	  </select>
	</td>
	<td>start range:<input type='text' name='start_range' value='30'></td>
	<td>end range:<input type='text' name='end_range' value='90'></td>
	<td><input type='submit'/></td>
      </tr>	  
    </table>
    </form>
  </li>
    
</ul>

{% endblock %}
